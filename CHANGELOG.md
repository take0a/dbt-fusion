# dbt Fusion Changelog
All notable changes to this project will be documented in this file.

- This file provides a full account of all changes to `dbt-fusion`
- Changes are listed under the (pre)release in which they first appear. Subsequent releases include changes from previous releases.
- "Breaking changes" listed under a version may require action from end users or external maintainers when upgrading to that version.
- Do not edit this file directly. This file is auto-generated using [changie](https://github.com/miniscruff/changie). For details on how to document a change, see [the contributing guide](CONTRIBUTING.md#adding-a-changelog-entry).

## dbt-fusion 2.0.0-preview.5 - August 22, 2025

### Features

- Issue package deprecation warnings in deps

### Fixes

- Allow `context.get("key", default)` without panicking
- fix error locations
- Fixed profile lookup not respecting urls in dbt_cloud.yaml

## dbt-fusion 2.0.0-preview.4 - August 21, 2025

### Features

- [adapters][databricks] Implemented required relation configs and changesets for streaming tables"
- dbt ignore & warn on python models

### Fixes

- fix schemas, database_schemas, and add node to run_result in jinja context in on-run-end
- Ensure log and target folder paths are correctly resolved as relative to --project-dir unless absolute paths are provided with --log-path or --target-path
- Remove noisy 'ADBC error: Internal:' and 'ADBC error: Unknown:' from messages 
- Do not show skipped node status for compile unless debug flag is set
- add error location in depends on 

### Under the Hood

- [adapters][databricks] Using the __attrs__ fields for relation config implementations, avoiding deprecated_config, added schedule to schema and persist_docs
- Only hydrate caches for selected nodes

## dbt-fusion 2.0.0-preview.3 - August 19, 2025

### Features

- Turn strict parsing on by default for running project
- Add deps detection for schema compatibility

### Fixes

- Add better support for windows installs
- Fix is_cte variable

## dbt-fusion 2.0.0-preview.1 - August 18, 2025

### Features

- Deps command issues installing message for each package
- support goto_def for source()
- Added hints based on existing profiles when running dbt init
- Compatibility warnings from dependencies will now be grouped as a single message per package; use --show-all-deprecations to display every individual warnin
- Add ability to fetch catalog info from warehouse for Snowflake
- Support namespace in type-checking; Add typecheck LSP
- Upgrade lsp to use channels instead of locking
- [ada
- [adapters][databricks][incremental] Implemented constraints for relation config changeset
- Add legal project name check to `dbt init` command.
- Added connection and credentilas lookup in dbt cloud when running dbt init
- New logging

### Fixes

- Fix null type conversion to match Python Agate and Core behavior. Null will now be converted to a number type, allowing seeding with an empty column.
- (dbt-auth): fix keypair across the board with more sophisticated parsing, error handling, detection, and recovery routines.
- Add a stub config for MSSQL
- Fix fqn generation and retrieval of project configs
- Allow rejection of duplicate test names with an error message similar to dbt core.
- Fix skipping hydrate on full compile
- Support Google Sheets and Google Cloud Storage external sources
- Windows: fix cli hang on exit
- Make modules.re.match() return a truthy value on a match
- Special handling of the 'execute' context variable
- Exclude system info_schema from AS JSON

### Under the Hood

- Use serde yml in schema files
- Demand caching of externalbrowser tokens. Do not rely on gosnowflake's promotion logic.
- Fancy logging for relation cache
- correctly use untagged enum macro
- Migrating from using serde_json to dbt_serde_yaml
- bump gosnowflake to include new v1.14.3 mfa and sso fixes caching.
- (fix adapters/bigquery) fix compile referencing time partitioning sources
- Add Databricks to RelationType conversion
- refactor return
- Fix return in type-check
- Adjusted deserialization logic for warehouse specific configs
- Use relation cache in defer

## dbt-fusion 2.0.0-beta.63 - August 11, 2025

### Features

- Adds a relation cache to reduce repeat get_relation calls
- Support cancelling commands with Ctrl+C
- [adapters] [databricks] [incremental] #4856 column comments changesets and tests
- Move to streaming diagnostics from the LSP

### Fixes

- Fix original file path location for operations
- Fix duplicate sub path in original path
- fix run operation stacktrace
- Fix static-analysis propagation across sources and tests

### Under the Hood

- project and dataset aliases for bigquery
- Internal testing infrastructure work

### Dependencies

- Driver bump for Postgres and Bigquery. Fixes empty record issue in Bigquery and static linking issues for Redshift/Postgres.

## dbt-fusion 2.0.0-beta.61 - August 08, 2025

### Features

- Begin writing catalog.json

### Fixes

- fix error location for dispatch call
- Respect `location` configuration in BigQuery
- Make env_var produce better error message and validate parameters more strictly
- fix caller with return
- (fix adapters/snowflake) bring back `database` to connection creations
- Correctly report unknown method errors on undefined values
- (fix adapters/snowflake) seed binary data
- Introduce VarProvider and to_dict() method

### Under the Hood

- profile.yml processing is now source-available
- Relax generic test json schema/structs
- Enable connect_timeout in snowflake profiles.

## dbt-fusion 2.0.0-beta.58 - August 05, 2025

### Fixes

- Detect safe introspection when accessing adapter methods through the 'dbt' namespace

### Under the Hood

- add builtins.sdf.yml       
- re-enable minijina tests
- (adapter/bigquery) support downloading schemas for information schema views

## dbt-fusion 2.0.0-beta.56 - August 01, 2025

### Features

- [Redshift] Materialized View Support
- New Anchors field in properties file to support yaml anchors w/o unused key warnings
- [Redshift] Redshift available in dbt init
- support --sample and --empty flags
- Add support for model level data tests

### Fixes

- fix jinja stacktrace
- Fixes Snowflake `profiles.yml` requiring `warehouse` key. It is now optional.
- Install jq if it's not installed already in the install script for unix

### Under the Hood

- Update golden files for tests with generic tests whose naming convention changed with conformance to dbt-core
- Better error messages for redshift IAM auth (not supported yet)

## dbt-fusion 2.0.0-beta.55 - July 30, 2025

## dbt-fusion 2.0.0-beta.54 - July 30, 2025

### Fixes

- Avoid printing debug messages when executing sql (this time for real)

## dbt-fusion 2.0.0-beta.52 - July 29, 2025

### Breaking Changes

- Update Custom and Alternate Generic Tests to use Arguments for any jinja args

### Features

- Implement yaml exposures

### Fixes

- Fix the output formats of tojson and toyaml
- Avoid printing debug messages when executing sql

## dbt-fusion 2.0.0-beta.51 - July 28, 2025

### Features

- Add support for snowflake ignore case
- Messages describing type mismatch for functions implemented using ArgsIter

### Fixes

- Remove unused 'patterned_dangling_sources' logic + command line flag
- Support Selector, Name, and Path output for list
- (fix adapter) skip adding a parse relation
- Fix updates_on configuration for model freshness
- Update cargo toml to include md5 crate and update generic test unit tests.
- Fix crash when calling count/index for tuples from Agate tables (e.g. column names)
- Allow hours, minutes and seconds format codes in strftime() on a date
- Make re.sub() support python style backslash backreferences

### Under the Hood

- Clean up some messages

## dbt-fusion 2.0.0-beta.49 - July 25, 2025

### Under the Hood

- fix jinja type check

## dbt-fusion 2.0.0-beta.48 - July 23, 2025

### Fixes

- Don't display internal qualifiers in error messages
- Make StaticBaseRelation more robust if 'primary_key' is missing
- Serialize complete freshness definition if partially defined
- add support for LIKE SOME/ANY/ALL in databricks dialect

### Under the Hood

- Cleanup some function args and types

## dbt-fusion 2.0.0-beta.46 - July 22, 2025

### Fixes

- (fix adapter/bigquery) support time_ingestion_partitioning partition_by config

### Under the Hood

- refactor jinja type check

## dbt-fusion 2.0.0-beta.45 - July 22, 2025

### Features

- Add support for 'as_text' on dynObject
- Performance improvements with cloning jinja and manifest serialization fix
- [Redshift] Metadata queries
- Implement ref restrictions based on access modifiers model
- Support the default execution timezone setting

### Fixes

- Change Snowflake auth concurrency control to avoid spamming users with too many tabs for externalbrowserauth
- fix model reference
- Enable render method for Big Query PartitionConfig
- [Redshift] Fix installation and URI handling for login
- [Adapters] Match core type translation
- support python negative step slice
- Fix message to mention that limit -1 needs to be used to remove limits for show
- Fix a bug in typecheck when breaking loop

### Under the Hood

- (adapter/databricks) Improve source schemas download logics
- (adapter) refactor get_column_values to not panic
-  (fix adapter/bigquery) BQ allows multi-stmt sql
- fix jinja type checking

## dbt-fusion 2.0.0-beta.44 - July 18, 2025

### Features

- Freshness on view w/o loaded_at_field warns about missing loaded_at_field.
- Update to cargo edition 2024

### Fixes

- Add ceil and floor methods for the round Jinja filter
- [Bigquery] Change Change bigquery job_*_seconds types from string to int
- Fix thread_id in run_result
- Fix jinja inconsistency for list.append and filter behavior for undefined
- apply project level configs to sources correctly

### Under the Hood

- chore: Make test utilities source available"
- (adapter/snowflake) download UDFs, register then compile
- Fix offset_window type in jsonschemas

## dbt-fusion 2.0.0-beta.43 - July 16, 2025

### Features

- Support overriding the dbt package hub url using DBT_PACKAGE_HUB_URL

## dbt-fusion 2.0.0-beta.42 - July 16, 2025

### Fixes

- Fix handling of some command line flags

## dbt-fusion 2.0.0-beta.41 - July 16, 2025

### Features

- Add build_after.updates_on support (dbt-labs/fs#4412) - dbt-labs/fs#3818

### Fixes

- Rename indent filter parameters (dbt-labs/fs#4389) - dbt-labs/dbt-fusion#379
- Allow profile environment variables to accept keyword arguments (dbt-labs/fs#4230) - dbt-labs/dbt-fusion#277
- The order of parsing positional arguments is important. Follow the same order as python (dbt-labs/fs#4463)
- support case insensitive bool for minijinja args (dbt-labs/fs#4462)

### Under the Hood

- (update adapter) allow access Config keys (dbt-labs/fs#4407)
- Cleanup some function args and types (dbt-labs/fs#4455)

## dbt-fusion 2.0.0-beta.40 - July 15, 2025

### Fixes

- Unit tests search for fixtures recurively (dbt-labs/fs#4435) - dbt-labs/dbt-fusion#362
- Fix source always considered fresh (dbt-labs/fs#4447)

## dbt-fusion 2.0.0-beta.38 - July 15, 2025

### Features

- Include custom test name in generic test unique_id if specified
- Validate test severity config and include warn/error enum options in jsonschema (dbt-labs/fs#4174) - dbt-labs/fs#3763
- Minor update macro checkpointing (dbt-labs/fs#4287)
- Issue message when deps installed version is not latest version (dbt-labs/fs#4310) - dbt-labs/dbt-fusion#326
- (adapter/bigquery) support adapter.grant_access_to (dbt-labs/fs#4291) - dbt-labs/fs#1513
- Support PerformTest (dbt-labs/fs#4403)

### Fixes

- Fix root project database schema overwrite package config (dbt-labs/fs#4385) - dbt-labs/dbt-fusion#187 dbt-labs/dbt-fusion#313
- (fix adapter/databricks) tolerate perm denied error for schema creations (dbt-labs/fs#4404) - dbt-labs/dbt-fusion#258
- Correcting Semantic Layer JSONSchema objects (dbt-labs/fs#4408)
- Fix two name fields in tarball package lock entry (dbt-labs/fs#4429)
- Fixes operation node incompatibility in manifest.json (dbt-labs/fs#4433)

### Under the Hood

- Improve accuracy of metrics jsonschemas (dbt-labs/fs#4380)
- refactor jinja check (dbt-labs/fs#4387)
- minor fixes of jinja check (dbt-labs/fs#4406)
- fix jinja-check (dbt-labs/fs#4423)
- Internal build cache (dbt-labs/fs#4442)

## dbt-fusion 2.0.0-beta.37 - July 10, 2025

### Features

- "Support typecheck for call statement"

### Under the Hood

- Remove unneeded space from error message (dbt-labs/fs#4351) - dbt-labs/fs#3623 dbt-labs/fs#3637

## dbt-fusion 2.0.0-beta.36 - July 10, 2025

### Features

- update profile jinja rendering to only apply to target output
- Add support for type checking in Jinja templates
- [Databricks] Update incremental macros to 1.10
- Implement tarball deps packages
- "Support typecheck for builtin return function"

### Fixes

- Handle git packages that differ only in subdirectory
- Fixed truthiness for snapshot timestamp warning
- fix bq target
- [Bigquery] Fix certain column data_types rendering incorrectly
- [Databricks] Fix serialization for nonstandard struct field names
- Correctly extract ok/error from invocation result
- Populate flags.WHICH with the correct value
- Fix dispatch logic for using macros in context object
- Fix parsing of BigQuery partition_by config
- Command line arguments take precedence over the default selector

### Under the Hood

- New dbt-serde_yaml mechanisms; more accurate yaml error locations
- Support the dev, canary, and latest release tracks
- move span into Instruction::CallFunction
- add the span to instructions

## dbt-fusion 2.0.0-beta.34 - July 07, 2025

### Features

- Implement deps --add-package
- implement exclude-resource-type flag
- [Databricks] Relation Configs Pt 1
- [Adapter][Snowflake/Bigquery/Databricks] Return empty columns list if relation is missing in adapter.get_columns_in_relation
- Reshape schemas to consolidate node specific configurations as attributes

### Fixes

- Restrict `log-path` to `logs` and `target-path` to `target`
- none is not iterable
- Remove the out of sync lock file
- Fix --output-keys flag to respect non default inputs #304
- Add support for recursive JsonSchema types with `__additional_properties`
- [Adapter][BigQuery] Support execution_project in profiles.yml
- gracefully handle deferral request errors and continue with no deferral
- [Databricks] Serialize DESCRIBE... JSON results
- Support grant merging with plus prefix in yaml or sql file
- Rewrite date_spine without introspective queries to enable a static analysis
- Drop `overrides` from source properties
- When the user uses this.incorporate, the corresponding database and schema directives should be respected.
- Add hint to run `dbt init` when profiles.yml isn't found, and warn that Cloud CLI isn't enabled yet when relevant

### Under the Hood

- use QUERY_DESTINATION_TABLE
- Robust and user-friendly arguments parser for minijinja
- Changes to assist debugging types mismatches from adapter.get_columns_in_relation
- Skip reading from local compilation results for snapshot

## dbt-fusion 2.0.0-beta.33 - July 01, 2025

### Fixes

-  Fixing --t , refining --thread 0 to stand for max-cpu, and use --threads parameter now also for io-bound computation
- enable_macro_span_for_if_stmt 
- Fixes a bug that prevented rendering of jinja in the profile value in the dbt_project.yml file.
- Fix default__generate_{}_name dispatch 
- Fix generic test with quoted column
- Create temporary directories in the project path so the rename does not fail
- support renaming on MutableMap
- Add adapter specific node config to all executable nodes
- should downcast a relation to a RelationObject

### Under the Hood

- Introduce strict-mode behind _DBT_FUSION_STRICT_MODE env var

## dbt-fusion 2.0.0-beta.32 - June 26, 2025

### Breaking Changes

- Support loaded_at_field and loaded_at_query in sources and tables config, not as properties

### Features

- Implement jinja exception "raise_contract_error"
- (adapter) enable use of type inferred columns in CSVs

### Fixes

- shorten file name length limit to account for .macro_span.json
- Limit -1 means no limit
- fix string bool manifest deserialization
- YAML Schema: fix type of `ModelConfig::tag` field
- Support index on list

### Under the Hood

- Define convenience macro for creating internal error
- fix errors swallowing

## dbt-fusion 2.0.0-beta.31 - June 26, 2025

### Fixes

- normalize special chars in source name
- Allow positional arguments in dictsort
- Fix model with CTE using ephemeral model
- Reverted timezone compatibility change due to 'chrono-tz' crate having an issue referencing 'uncased' crate
- Ignore .jinja files in macro and test paths for conformance with dbt-core
- Fix Selector Exclusion

### Under the Hood

- Serialize configs via resource_types

## dbt-fusion 2.0.0-beta.30 - June 25, 2025

### Fixes

- Make semantic model entity configs optional
- Fix BQ seed with custom schema

## dbt-fusion 2.0.0-beta.29 - June 25, 2025

### Features

- Implement jinja exceptions
- (adapter bigquery) enable seed ingestion
- Add 'static_analysis' property to all analyzeable nodes, ensure sources adapt static_analysis to failures

### Fixes

- Make modules.pytz.timezone compatible with dbt-core by tlm365.
- Fix `DbtContract` defaults for serialization
- Fix error while loading defer manifest
- fix panic in incorporate
- Add store_result and load_result macros to run-operation jinja context
- Fix quoting config not respected in various places - Automatic catalog/schema creation - api.Relation.create Jinja function

## dbt-fusion 2.0.0-beta.28 - June 24, 2025

### Fixes

- Respect quote config in column test generation
- Support string or array of strings for databricks liquid_clustered_by config + add missing merge configs
- fix map_to_workspace_path
- Fix span reporting for source yaml issues
- Fix respecting static_analysis project, properties, and config

## dbt-fusion 2.0.0-beta.27 - June 23, 2025

### Fixes

- correctly resolve selector inheritence
- Fix exlusion logic so exclusion happens after selection and indirect selection

## dbt-fusion 2.0.0-beta.26 - June 23, 2025

### Features

- Support datetime in seed
- Collect refs and sources in pre/post hooks and provide better error message for unrecognized refs at compile time
- Support auto deferral

### Fixes

- fix snowflake_warehouse config not respected
- No longer create empty schema on DataFrame collect error

## dbt-fusion 2.0.0-beta.25 - June 20, 2025

### Features

- Support datetime in seed

### Fixes

- Add missing `warn_unenforced` to `Constraint` and split out `ModelConstraint`
- `profiles.yml` in all log output instead of `profile.yml`
- Refactor nodes to leverage respective configs over 'DbtConfig' superset
- fix the incorrect source filename some render error
- Jinja: refine dangling block end check
- Fix missing 'materialized' property in snapshot config
- Fix Exosure Properties Expected Schema

### Under the Hood

- Error handling: eliminate MinijinjaError implicit conversion

## dbt-fusion 2.0.0-beta.24 - June 18, 2025

### Fixes

- Fix parse_fqn with trailing semicolon for Snowflake
- [BigQuery] Fix type translation for STRING type
- Improve the mat macro lookup logic

### Under the Hood

- Add support for parsing catalogs.yml files
- (dbt-agate) add all 4 arrow timestamp types as Arrow2Jinja converters.
- Include properties of built-in generic tests in jsonschemas
- Fix telemetry timestamps
- Introduce mechanism for error recovery on Yaml deserialization

## dbt-fusion 2.0.0-beta.23 - June 17, 2025

### Features

- Support dbt_project.yml config support for exposures
- Support parsing redshift-specific configs
- Add redact_credentials method for databricks.

### Fixes

- Validate --vars key-value pairs that do not have a space between key and value
- Collect only prescribed set of directories for docs

### Under the Hood

- Fix missing locations in Yaml related errors
- listener generates macro_spans
- Remove unused crate dependencies
- Use FsError in more places

## dbt-fusion 2.0.0-beta.22 - June 12, 2025

### Fixes

- Use absolute paths for error reporting when reading yml files
- Remove unnecessary flatten directive
- this.MaterializedView is missing
- Fixes missing resource_type in materialize stage
- Ensure snapshots have 'materialized' set to snapshot

### Under the Hood

- [Adapters] Added literal formatting layer for dialect aware translations
- fixes

## dbt-fusion 2.0.0-beta.20 - June 11, 2025

### Features

- Implement --send-anonymous-usage-stats
- Introduce context['...'] for macro lookups

### Fixes

- Ensure on-run-start / end have context[...] object

### Under the Hood

- Add driver level REPL

## dbt-fusion 2.0.0-beta.18 - June 10, 2025

### Features

- (databricks-adapter) get_relation_config and get_config_from_model methods start
- [Databricks] Add get_persist_doc_columns

### Fixes

- Updated column cast to have a better error message
- Add missing 'skip_serializing_none' to reduce the manifest size
- Fixes ambiguity in DATE rendering by adding single quotes
- Fix duplicate snapshot ingestion when projects begin with 'dbt_'

### Under the Hood

- Logging: remove the global logger lock
- patch config.model

## dbt-fusion 2.0.0-beta.16 - June 06, 2025

### Fixes

- (fix snowflake-adapter) pass query_tag from dbt_project.yml
- Use build_model_context for ref and source extraction environment
- Use OS services to check TLS certificates
- fix config.model
- resolve project configs relative to resource path
- Fix for go to definitions for jinja functions containing a 'return'
- Fix skipping custom generate_{}_name macro when projects suffixed with '_dbt' & missing resource_type in graph / manifest.json & case sensitive extensions
- Refactor node context initialization to have independent stateful fn init

### Under the Hood

- Bump snowflake driver to patch gosnowflake, arrow-adbc, and fs. Reverts PR 3709 which has been patched in the driver now.
- Remove unused shared mutable global state

## dbt-fusion 2.0.0-beta.15 - June 04, 2025

### Features

- Support `catalog` config for databricks model configs
- Split render & analyze phases into separate progress options

## dbt-fusion 2.0.0-beta.14 - June 03, 2025

### Features

- implement union for seq in minijinja
- New event based progress bar functionality for cli
- Add dict function support on tuples in minijinja

### Fixes

- Fix the databricks function try_to_number() return type
- Allow catalog in sources properties (alias for database)

### Under the Hood

- Bump databricks driver to 0.18.0+dbt0.0.4
- Bump databricks driver to 0.18.0+dbt0.0.5

## dbt-fusion 2.0.0-beta.13 - May 30, 2025

### Fixes

- Improved dbt Fusion show stability for VS Code extension previews by removing schema / type checking
- Removed unnecessary language server compilation failure message "Failed to Resolve" 
- Added error on parsing `flags` and `config` properties in `profiles.yml`, as they no longer do anything and are skipped during Fusion parse
- Improved stability of LSP incremental recompilation  
- Fixed duplicate model name parsing bug ([#63](https://github.com/dbt-labs/dbt-fusion/issues/63))
- Added support for `DBT_PROFILES_DIR` and other env vars in dbt LSP and `profiles.yml`
- Added support for `add_query` adapter method in Databricks
- Added support for Date32/64 and Time32/64 types in dbt Fusion Agate (`stfrtime` method for example). Partially addressed [#79](https://github.com/dbt-labs/dbt-fusion/issues/79)
- Fixed issue with unit test refs / dependencies not being respected
- Fixed issue where `static_analysis` config is not respected in YML
